{"version":3,"names":["packageManagers","yarn","init","install","installDev","uninstall","installAll","npm","bun","configurePackageManager","packageNames","action","options","pm","shouldUseYarn","packageManager","shouldUseBun","executable","flags","args","executeCommand","command","execa","stdio","silent","logger","isVerbose","cwd","root","getYarnVersionIfAvailable","isProjectUsingYarn","getBunVersionIfAvailable","isProjectUsingBun","shouldUseNpm","getNpmVersionIfAvailable","isProjectUsingNpm"],"sources":["../../src/tools/packageManager.ts"],"sourcesContent":["import execa from 'execa';\nimport {logger} from '@react-native-community/cli-tools';\nimport {getYarnVersionIfAvailable, isProjectUsingYarn} from './yarn';\nimport {getBunVersionIfAvailable, isProjectUsingBun} from './bun';\nimport {getNpmVersionIfAvailable, isProjectUsingNpm} from './npm';\n\nexport type PackageManager = keyof typeof packageManagers;\n\ntype Options = {\n  packageManager: PackageManager;\n  silent?: boolean;\n  root: string;\n};\n\nconst packageManagers = {\n  yarn: {\n    init: ['init', '-y'],\n    install: ['add'],\n    installDev: ['add', '-D'],\n    uninstall: ['remove'],\n    installAll: ['install'],\n  },\n  npm: {\n    init: ['init', '-y'],\n    install: ['install', '--save', '--save-exact'],\n    installDev: ['install', '--save-dev', '--save-exact'],\n    uninstall: ['uninstall', '--save'],\n    installAll: ['install'],\n  },\n  bun: {\n    init: ['init', '-y'],\n    install: ['add', '--exact'],\n    installDev: ['add', '--dev', '--exact'],\n    uninstall: ['remove'],\n    installAll: ['install'],\n  },\n};\n\nfunction configurePackageManager(\n  packageNames: Array<string>,\n  action: 'init' | 'install' | 'installDev' | 'installAll' | 'uninstall',\n  options: Options,\n) {\n  let pm: PackageManager = shouldUseYarn(options) ? 'yarn' : 'npm';\n  if (options.packageManager === 'bun') {\n    pm = shouldUseBun(options) ? 'bun' : 'npm';\n  }\n\n  const [executable, ...flags] = packageManagers[pm][action];\n  const args = [executable, ...flags, ...packageNames];\n  return executeCommand(pm, args, options);\n}\n\nfunction executeCommand(\n  command: string,\n  args: Array<string>,\n  options: Options,\n) {\n  return execa(command, args, {\n    stdio: options.silent && !logger.isVerbose() ? 'pipe' : 'inherit',\n    cwd: options.root,\n  });\n}\n\nexport function shouldUseYarn(options: Options) {\n  if (options.packageManager === 'yarn') {\n    return getYarnVersionIfAvailable();\n  }\n  return isProjectUsingYarn(options.root) && getYarnVersionIfAvailable();\n}\n\nexport function shouldUseBun(options: Options) {\n  if (options.packageManager === 'bun') {\n    return getBunVersionIfAvailable();\n  }\n\n  return isProjectUsingBun(options.root) && getBunVersionIfAvailable();\n}\n\nexport function shouldUseNpm(options: Options) {\n  if (options.packageManager === 'npm') {\n    return getNpmVersionIfAvailable();\n  }\n\n  return isProjectUsingNpm(options.root) && getNpmVersionIfAvailable();\n}\n\nexport function init(options: Options) {\n  return configurePackageManager([], 'init', options);\n}\n\nexport function install(packageNames: Array<string>, options: Options) {\n  return configurePackageManager(packageNames, 'install', options);\n}\n\nexport function installDev(packageNames: Array<string>, options: Options) {\n  return configurePackageManager(packageNames, 'installDev', options);\n}\n\nexport function uninstall(packageNames: Array<string>, options: Options) {\n  return configurePackageManager(packageNames, 'uninstall', options);\n}\n\nexport function installAll(options: Options) {\n  return configurePackageManager([], 'installAll', options);\n}\n"],"mappings":";;;;;;;;;;;;;AAAA;EAAA;EAAA;IAAA;EAAA;EAAA;AAAA;AACA;EAAA;EAAA;IAAA;EAAA;EAAA;AAAA;AACA;AACA;AACA;AAAkE;AAUlE,MAAMA,eAAe,GAAG;EACtBC,IAAI,EAAE;IACJC,IAAI,EAAE,CAAC,MAAM,EAAE,IAAI,CAAC;IACpBC,OAAO,EAAE,CAAC,KAAK,CAAC;IAChBC,UAAU,EAAE,CAAC,KAAK,EAAE,IAAI,CAAC;IACzBC,SAAS,EAAE,CAAC,QAAQ,CAAC;IACrBC,UAAU,EAAE,CAAC,SAAS;EACxB,CAAC;EACDC,GAAG,EAAE;IACHL,IAAI,EAAE,CAAC,MAAM,EAAE,IAAI,CAAC;IACpBC,OAAO,EAAE,CAAC,SAAS,EAAE,QAAQ,EAAE,cAAc,CAAC;IAC9CC,UAAU,EAAE,CAAC,SAAS,EAAE,YAAY,EAAE,cAAc,CAAC;IACrDC,SAAS,EAAE,CAAC,WAAW,EAAE,QAAQ,CAAC;IAClCC,UAAU,EAAE,CAAC,SAAS;EACxB,CAAC;EACDE,GAAG,EAAE;IACHN,IAAI,EAAE,CAAC,MAAM,EAAE,IAAI,CAAC;IACpBC,OAAO,EAAE,CAAC,KAAK,EAAE,SAAS,CAAC;IAC3BC,UAAU,EAAE,CAAC,KAAK,EAAE,OAAO,EAAE,SAAS,CAAC;IACvCC,SAAS,EAAE,CAAC,QAAQ,CAAC;IACrBC,UAAU,EAAE,CAAC,SAAS;EACxB;AACF,CAAC;AAED,SAASG,uBAAuB,CAC9BC,YAA2B,EAC3BC,MAAsE,EACtEC,OAAgB,EAChB;EACA,IAAIC,EAAkB,GAAGC,aAAa,CAACF,OAAO,CAAC,GAAG,MAAM,GAAG,KAAK;EAChE,IAAIA,OAAO,CAACG,cAAc,KAAK,KAAK,EAAE;IACpCF,EAAE,GAAGG,YAAY,CAACJ,OAAO,CAAC,GAAG,KAAK,GAAG,KAAK;EAC5C;EAEA,MAAM,CAACK,UAAU,EAAE,GAAGC,KAAK,CAAC,GAAGlB,eAAe,CAACa,EAAE,CAAC,CAACF,MAAM,CAAC;EAC1D,MAAMQ,IAAI,GAAG,CAACF,UAAU,EAAE,GAAGC,KAAK,EAAE,GAAGR,YAAY,CAAC;EACpD,OAAOU,cAAc,CAACP,EAAE,EAAEM,IAAI,EAAEP,OAAO,CAAC;AAC1C;AAEA,SAASQ,cAAc,CACrBC,OAAe,EACfF,IAAmB,EACnBP,OAAgB,EAChB;EACA,OAAO,IAAAU,gBAAK,EAACD,OAAO,EAAEF,IAAI,EAAE;IAC1BI,KAAK,EAAEX,OAAO,CAACY,MAAM,IAAI,CAACC,kBAAM,CAACC,SAAS,EAAE,GAAG,MAAM,GAAG,SAAS;IACjEC,GAAG,EAAEf,OAAO,CAACgB;EACf,CAAC,CAAC;AACJ;AAEO,SAASd,aAAa,CAACF,OAAgB,EAAE;EAC9C,IAAIA,OAAO,CAACG,cAAc,KAAK,MAAM,EAAE;IACrC,OAAO,IAAAc,+BAAyB,GAAE;EACpC;EACA,OAAO,IAAAC,wBAAkB,EAAClB,OAAO,CAACgB,IAAI,CAAC,IAAI,IAAAC,+BAAyB,GAAE;AACxE;AAEO,SAASb,YAAY,CAACJ,OAAgB,EAAE;EAC7C,IAAIA,OAAO,CAACG,cAAc,KAAK,KAAK,EAAE;IACpC,OAAO,IAAAgB,6BAAwB,GAAE;EACnC;EAEA,OAAO,IAAAC,sBAAiB,EAACpB,OAAO,CAACgB,IAAI,CAAC,IAAI,IAAAG,6BAAwB,GAAE;AACtE;AAEO,SAASE,YAAY,CAACrB,OAAgB,EAAE;EAC7C,IAAIA,OAAO,CAACG,cAAc,KAAK,KAAK,EAAE;IACpC,OAAO,IAAAmB,6BAAwB,GAAE;EACnC;EAEA,OAAO,IAAAC,sBAAiB,EAACvB,OAAO,CAACgB,IAAI,CAAC,IAAI,IAAAM,6BAAwB,GAAE;AACtE;AAEO,SAAShC,IAAI,CAACU,OAAgB,EAAE;EACrC,OAAOH,uBAAuB,CAAC,EAAE,EAAE,MAAM,EAAEG,OAAO,CAAC;AACrD;AAEO,SAAST,OAAO,CAACO,YAA2B,EAAEE,OAAgB,EAAE;EACrE,OAAOH,uBAAuB,CAACC,YAAY,EAAE,SAAS,EAAEE,OAAO,CAAC;AAClE;AAEO,SAASR,UAAU,CAACM,YAA2B,EAAEE,OAAgB,EAAE;EACxE,OAAOH,uBAAuB,CAACC,YAAY,EAAE,YAAY,EAAEE,OAAO,CAAC;AACrE;AAEO,SAASP,SAAS,CAACK,YAA2B,EAAEE,OAAgB,EAAE;EACvE,OAAOH,uBAAuB,CAACC,YAAY,EAAE,WAAW,EAAEE,OAAO,CAAC;AACpE;AAEO,SAASN,UAAU,CAACM,OAAgB,EAAE;EAC3C,OAAOH,uBAAuB,CAAC,EAAE,EAAE,YAAY,EAAEG,OAAO,CAAC;AAC3D"}